import{a as I,s as b,h as B,D as C}from"./hyphenate-65d9bac0.js";/* empty css                          *//* empty css              */import{Sanscript as A}from"https://tst-project.github.io/lib/js/sanscript.mjs";var x={},k={get exports(){return x},set exports(o){x=o}},w={};(function(o){var r=o,h=/`/g,c=/\./g,y=/[']/g,E={"'":"''"};r.escapeId=function(e,n){if(Array.isArray(e)){for(var t="",s=0;s<e.length;s++)t+=(s===0?"":", ")+r.escapeId(e[s],n);return t}else return n?"`"+String(e).replace(h,"``")+"`":"`"+String(e).replace(h,"``").replace(c,"`.`")+"`"},r.escape=function(e,n,t){if(e==null)return"NULL";switch(typeof e){case"boolean":return e?"true":"false";case"number":return e+"";case"object":return e instanceof Date?r.dateToString(e,t||"local"):Array.isArray(e)?r.arrayToList(e,t):Buffer.isBuffer(e)?r.bufferToString(e):typeof e.toSqlString=="function"?String(e.toSqlString()):n?d(e.toString()):r.objectToValues(e,t);default:return d(e)}},r.arrayToList=function(e,n){for(var t="",s=0;s<e.length;s++){var i=e[s];Array.isArray(i)?t+=(s===0?"":", ")+"("+r.arrayToList(i,n)+")":t+=(s===0?"":", ")+r.escape(i,!0,n)}return t},r.format=function(e,n,t,s){if(n==null)return e;n instanceof Array||Array.isArray(n)||(n=[n]);for(var i=0,p=/\?+/g,f="",u=0,g;u<n.length&&(g=p.exec(e));){var m=g[0].length;if(!(m>2)){var S=m===2?r.escapeId(n[u]):r.escape(n[u],t,s);f+=e.slice(i,g.index)+S,i=p.lastIndex,u++}}return i===0?e:i<e.length?f+e.slice(i):f},r.dateToString=function(e,n){var t=new Date(e);if(isNaN(t.getTime()))return"NULL";var s,i,p,f,u,g,m;if(n==="local")s=t.getFullYear(),i=t.getMonth()+1,p=t.getDate(),f=t.getHours(),u=t.getMinutes(),g=t.getSeconds(),m=t.getMilliseconds();else{var S=T(n);S!==!1&&S!==0&&t.setTime(t.getTime()+S*6e4),s=t.getUTCFullYear(),i=t.getUTCMonth()+1,p=t.getUTCDate(),f=t.getUTCHours(),u=t.getUTCMinutes(),g=t.getUTCSeconds(),m=t.getUTCMilliseconds()}var v=l(s,4)+"-"+l(i,2)+"-"+l(p,2)+" "+l(f,2)+":"+l(u,2)+":"+l(g,2)+"."+l(m,3);return d(v)},r.bufferToString=function(e){return"X"+d(e.toString("hex"))},r.objectToValues=function(e,n){var t="";for(var s in e){var i=e[s];typeof i!="function"&&(t+=(t.length===0?"":", ")+r.escapeId(s)+" = "+r.escape(i,!0,n))}return t},r.raw=function(e){if(typeof e!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return e}}};function d(a){for(var e=y.lastIndex=0,n="",t;t=y.exec(a);)n+=a.slice(e,t.index)+E[t[0]],e=y.lastIndex;return e===0?"'"+a+"'":e<a.length?"'"+n+a.slice(e)+"'":"'"+n+"'"}function l(a,e){for(a=a.toString();a.length<e;)a="0"+a;return a}function T(a){if(a==="Z")return 0;var e=a.match(/([\+\-\s])(\d\d):?(\d\d)?/);return e?(e[1]==="-"?-1:1)*(parseInt(e[2],10)+(e[3]?parseInt(e[3],10):0)/60)*60:!1}})(w);(function(o){o.exports=w})(k);const q=I(x),M=async o=>{document.getElementById("spinner").style.display="flex";const r=await b("/mss/db/fts.db"),h=o.replaceAll("ए","ऎ").replaceAll("ओ","ऒ").replaceAll("े","ॆ").replaceAll("ो","ॊ"),c=A.t(A.t(h,"tamil","iast"),"devanagari","iast").replace(/^⁰|([^\d⁰])⁰/g,"$1¹⁰"),y=q.escape(c).replace(/"/g,'""').replace(/^'/,`'"`).replace(/'$/,`"'`),E=await r.db.exec(`SELECT filename, shelfmark, title, snippet(fulltext,3,'<span class="highlit">','</span>','…',200) AS snippet FROM fulltext WHERE text MATCH ${y} ORDER BY rank`);if(document.getElementById("spinner").style.display="none",E.length===0){document.getElementById("noresulttext").textContent=c,document.getElementById("noresult").style.visibility="visible";return}const d=E[0].values.map(l=>{const T=`<a href="/mss/${l[0]}" class="shelfmark">${l[1]}</a>`,a=B(l[2]);return[T,a,l[3]]});document.getElementById("index").style.visibility="visible",new C("#index",{searchable:!0,language:{search:"Filter:"},paging:!0,pageLength:100,lengthMenu:[[25,50,100,-1],[25,50,100,"All"]],sortable:!0,scrollX:!0,data:d,columns:[{title:"shelfmark",type:"shelfmark"},{title:"title",type:"tamil"},{title:"search result"}]})},L=o=>{const r=new URLSearchParams(window.location.search);r.set("q",o),window.location.search=r};document.getElementById("ftsinput").addEventListener("keyup",o=>{if(event.keyCode!==13)return;const r=o.target.value.trim();r!==""&&L(r)});document.getElementById("ftsbutton").addEventListener("click",o=>{const r=document.getElementById("ftsinput").value.trim();r!==""&&L(r)});const P=o=>{const r=document.getElementById("ftsinput"),c=new URLSearchParams(window.location.search).get("q");c&&(r.value=c,M(c)),r.style.visibility="visible"};window.addEventListener("DOMContentLoaded",P);

import{a as I,s as v,h as C,D as B}from"./hyphenate-21a7b665.js";/* empty css                          *//* empty css              */import{Sanscript as A}from"https://tst-project.github.io/lib/js/sanscript.mjs";var E={},b={get exports(){return E},set exports(c){E=c}},w={};(function(c){var n=c,l=/`/g,S=/\./g,m=/[']/g,T={"'":"''"};n.escapeId=function(e,r){if(Array.isArray(e)){for(var t="",s=0;s<e.length;s++)t+=(s===0?"":", ")+n.escapeId(e[s],r);return t}else return r?"`"+String(e).replace(l,"``")+"`":"`"+String(e).replace(l,"``").replace(S,"`.`")+"`"},n.escape=function(e,r,t){if(e==null)return"NULL";switch(typeof e){case"boolean":return e?"true":"false";case"number":return e+"";case"object":return e instanceof Date?n.dateToString(e,t||"local"):Array.isArray(e)?n.arrayToList(e,t):Buffer.isBuffer(e)?n.bufferToString(e):typeof e.toSqlString=="function"?String(e.toSqlString()):r?d(e.toString()):n.objectToValues(e,t);default:return d(e)}},n.arrayToList=function(e,r){for(var t="",s=0;s<e.length;s++){var i=e[s];Array.isArray(i)?t+=(s===0?"":", ")+"("+n.arrayToList(i,r)+")":t+=(s===0?"":", ")+n.escape(i,!0,r)}return t},n.format=function(e,r,t,s){if(r==null)return e;r instanceof Array||Array.isArray(r)||(r=[r]);for(var i=0,p=/\?+/g,f="",u=0,g;u<r.length&&(g=p.exec(e));){var h=g[0].length;if(!(h>2)){var y=h===2?n.escapeId(r[u]):n.escape(r[u],t,s);f+=e.slice(i,g.index)+y,i=p.lastIndex,u++}}return i===0?e:i<e.length?f+e.slice(i):f},n.dateToString=function(e,r){var t=new Date(e);if(isNaN(t.getTime()))return"NULL";var s,i,p,f,u,g,h;if(r==="local")s=t.getFullYear(),i=t.getMonth()+1,p=t.getDate(),f=t.getHours(),u=t.getMinutes(),g=t.getSeconds(),h=t.getMilliseconds();else{var y=x(r);y!==!1&&y!==0&&t.setTime(t.getTime()+y*6e4),s=t.getUTCFullYear(),i=t.getUTCMonth()+1,p=t.getUTCDate(),f=t.getUTCHours(),u=t.getUTCMinutes(),g=t.getUTCSeconds(),h=t.getUTCMilliseconds()}var L=o(s,4)+"-"+o(i,2)+"-"+o(p,2)+" "+o(f,2)+":"+o(u,2)+":"+o(g,2)+"."+o(h,3);return d(L)},n.bufferToString=function(e){return"X"+d(e.toString("hex"))},n.objectToValues=function(e,r){var t="";for(var s in e){var i=e[s];typeof i!="function"&&(t+=(t.length===0?"":", ")+n.escapeId(s)+" = "+n.escape(i,!0,r))}return t},n.raw=function(e){if(typeof e!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return e}}};function d(a){for(var e=m.lastIndex=0,r="",t;t=m.exec(a);)r+=a.slice(e,t.index)+T[t[0]],e=m.lastIndex;return e===0?"'"+a+"'":e<a.length?"'"+r+a.slice(e)+"'":"'"+r+"'"}function o(a,e){for(a=a.toString();a.length<e;)a="0"+a;return a}function x(a){if(a==="Z")return 0;var e=a.match(/([\+\-\s])(\d\d):?(\d\d)?/);return e?(e[1]==="-"?-1:1)*(parseInt(e[2],10)+(e[3]?parseInt(e[3],10):0)/60)*60:!1}})(w);(function(c){c.exports=w})(b);const q=I(E),R=async c=>{document.getElementById("spinner").style.display="flex";const n=await v("/mss/db/fts.db"),l=c.replaceAll("ए","ऎ").replaceAll("ओ","ऒ").replaceAll("े","ॆ").replaceAll("ो","ॊ"),S=A.t(A.t(l,"tamil","iast"),"devanagari","iast").replace(/^⁰|([^\d⁰])⁰/g,"$1¹⁰"),m=q.escape(S).replace(/"/g,'""').replace(/^'/,`'"`).replace(/'$/,`"'`),T=await n.db.exec(`SELECT filename, shelfmark, title, snippet(fulltext,3,'<span class="highlit">','</span>','…',200) AS snippet FROM fulltext WHERE text MATCH ${m} ORDER BY rank`);if(document.getElementById("spinner").style.display="none",T.length===0){document.getElementById("noresulttext").textContent=S,document.getElementById("noresult").style.visibility="visible";return}const d=T[0].values.map(o=>{const x=`<a href="/mss/${o[0]}" class="shelfmark">${o[1]}</a>`,a=C(o[2]);return[x,a,o[3]]});document.getElementById("index").style.visibility="visible",new B("#index",{searchable:!0,language:{search:"Filter:"},paging:!0,pageLength:100,lengthMenu:[[25,50,100,-1],[25,50,100,"All"]],sortable:!0,data:d,columns:[{title:"shelfmark",type:"shelfmark"},{title:"title",type:"tamil"},{title:"search result"}]})};document.getElementById("ftsinput").addEventListener("keyup",c=>{if(event.keyCode!==13)return;const n=c.target.value.trim();if(n==="")return;const l=new URLSearchParams(window.location.search);l.set("q",n),window.location.search=l});const U=c=>{const l=new URLSearchParams(window.location.search).get("q");l&&(document.getElementById("ftsinput").value=l,R(l))};window.addEventListener("load",U);

import{$ as r,D as y,h as _,s as z}from"./hyphenate-21a7b665.js";/*! Responsive 2.4.1
 * Â© SpryMedia Ltd - datatables.net/license
 */var b=function(e,t){if(!y.versionCheck||!y.versionCheck("1.10.10"))throw"DataTables Responsive requires DataTables 1.10.10 or newer";this.s={childNodeStore:{},columns:[],current:[],dt:new y.Api(e)},!this.s.dt.settings()[0].responsive&&(t&&typeof t.details=="string"?t.details={type:t.details}:t&&t.details===!1?t.details={type:!1}:t&&t.details===!0&&(t.details={type:"inline"}),this.c=r.extend(!0,{},b.defaults,y.defaults.responsive,t),e.responsive=this,this._constructor())};r.extend(b.prototype,{_constructor:function(){var e=this,t=this.s.dt,s=t.settings()[0],n=r(window).innerWidth();t.settings()[0]._responsive=this,r(window).on("resize.dtr orientationchange.dtr",y.util.throttle(function(){var o=r(window).innerWidth();o!==n&&(e._resize(),n=o)})),s.oApi._fnCallbackReg(s,"aoRowCreatedCallback",function(o,a,l){r.inArray(!1,e.s.current)!==-1&&r(">td, >th",o).each(function(d){var u=t.column.index("toData",d);e.s.current[u]===!1&&r(this).css("display","none")})}),t.on("destroy.dtr",function(){t.off(".dtr"),r(t.table().body()).off(".dtr"),r(window).off("resize.dtr orientationchange.dtr"),t.cells(".dtr-control").nodes().to$().removeClass("dtr-control"),r.each(e.s.current,function(o,a){a===!1&&e._setColumnVis(o,!0)})}),this.c.breakpoints.sort(function(o,a){return o.width<a.width?1:o.width>a.width?-1:0}),this._classLogic(),this._resizeAuto();var i=this.c.details;i.type!==!1&&(e._detailsInit(),t.on("column-visibility.dtr",function(){e._timer&&clearTimeout(e._timer),e._timer=setTimeout(function(){e._timer=null,e._classLogic(),e._resizeAuto(),e._resize(!0),e._redrawChildren()},100)}),t.on("draw.dtr",function(){e._redrawChildren()}),r(t.table().node()).addClass("dtr-"+i.type)),t.on("column-reorder.dtr",function(o,a,l){e._classLogic(),e._resizeAuto(),e._resize(!0)}),t.on("column-sizing.dtr",function(){e._resizeAuto(),e._resize()}),t.on("column-calc.dt",function(o,a){for(var l=e.s.current,d=0;d<l.length;d++){var u=a.visible.indexOf(d);l[d]===!1&&u>=0&&a.visible.splice(u,1)}}),t.on("preXhr.dtr",function(){var o=[];t.rows().every(function(){this.child.isShown()&&o.push(this.id(!0))}),t.one("draw.dtr",function(){e._resizeAuto(),e._resize(),t.rows(o).every(function(){e._detailsDisplay(this,!1)})})}),t.on("draw.dtr",function(){e._controlClass()}).on("init.dtr",function(o,a,l){o.namespace==="dt"&&(e._resizeAuto(),e._resize(),r.inArray(!1,e.s.current)&&t.columns.adjust())}),this._resize()},_childNodes:function(e,t,s){var n=t+"-"+s;if(this.s.childNodeStore[n])return this.s.childNodeStore[n];for(var i=[],o=e.cell(t,s).node().childNodes,a=0,l=o.length;a<l;a++)i.push(o[a]);return this.s.childNodeStore[n]=i,i},_childNodesRestore:function(e,t,s){var n=t+"-"+s;if(this.s.childNodeStore[n]){for(var i=e.cell(t,s).node(),o=this.s.childNodeStore[n],a=o[0].parentNode,l=a.childNodes,d=[],u=0,p=l.length;u<p;u++)d.push(l[u]);for(var c=0,f=d.length;c<f;c++)i.appendChild(d[c]);this.s.childNodeStore[n]=void 0}},_columnsVisiblity:function(e){var t=this.s.dt,s=this.s.columns,n,i,o=s.map(function(h,w){return{columnIdx:w,priority:h.priority}}).sort(function(h,w){return h.priority!==w.priority?h.priority-w.priority:h.columnIdx-w.columnIdx}),a=r.map(s,function(h,w){return t.column(w).visible()===!1?"not-visible":h.auto&&h.minWidth===null?!1:h.auto===!0?"-":r.inArray(e,h.includeIn)!==-1}),l=0;for(n=0,i=a.length;n<i;n++)a[n]===!0&&(l+=s[n].minWidth);var d=t.settings()[0].oScroll,u=d.sY||d.sX?d.iBarWidth:0,p=t.table().container().offsetWidth-u,c=p-l;for(n=0,i=a.length;n<i;n++)s[n].control&&(c-=s[n].minWidth);var f=!1;for(n=0,i=o.length;n<i;n++){var v=o[n].columnIdx;a[v]==="-"&&!s[v].control&&s[v].minWidth&&(f||c-s[v].minWidth<0?(f=!0,a[v]=!1):a[v]=!0,c-=s[v].minWidth)}var x=!1;for(n=0,i=s.length;n<i;n++)if(!s[n].control&&!s[n].never&&a[n]===!1){x=!0;break}for(n=0,i=s.length;n<i;n++)s[n].control&&(a[n]=x),a[n]==="not-visible"&&(a[n]=!1);return r.inArray(!0,a)===-1&&(a[0]=!0),a},_classLogic:function(){var e=this,t=this.c.breakpoints,s=this.s.dt,n=s.columns().eq(0).map(function(a){var l=this.column(a),d=l.header().className,u=s.settings()[0].aoColumns[a].responsivePriority,p=l.header().getAttribute("data-priority");return u===void 0&&(u=p==null?1e4:p*1),{className:d,includeIn:[],auto:!1,control:!1,never:!!d.match(/\b(dtr\-)?never\b/),priority:u}}),i=function(a,l){var d=n[a].includeIn;r.inArray(l,d)===-1&&d.push(l)},o=function(a,l,d,u){var p,c,f;if(!d)n[a].includeIn.push(l);else if(d==="max-")for(p=e._find(l).width,c=0,f=t.length;c<f;c++)t[c].width<=p&&i(a,t[c].name);else if(d==="min-")for(p=e._find(l).width,c=0,f=t.length;c<f;c++)t[c].width>=p&&i(a,t[c].name);else if(d==="not-")for(c=0,f=t.length;c<f;c++)t[c].name.indexOf(u)===-1&&i(a,t[c].name)};n.each(function(a,l){for(var d=a.className.split(" "),u=!1,p=0,c=d.length;p<c;p++){var f=d[p].trim();if(f==="all"||f==="dtr-all"){u=!0,a.includeIn=r.map(t,function(v){return v.name});return}else if(f==="none"||f==="dtr-none"||a.never){u=!0;return}else if(f==="control"||f==="dtr-control"){u=!0,a.control=!0;return}r.each(t,function(v,x){var h=x.name.split("-"),w=new RegExp("(min\\-|max\\-|not\\-)?("+h[0]+")(\\-[_a-zA-Z0-9])?"),m=f.match(w);m&&(u=!0,m[2]===h[0]&&m[3]==="-"+h[1]?o(l,x.name,m[1],m[2]+m[3]):m[2]===h[0]&&!m[3]&&o(l,x.name,m[1],m[2]))})}u||(a.auto=!0)}),this.s.columns=n},_controlClass:function(){if(this.c.details.type==="inline"){var e=this.s.dt,t=this.s.current,s=r.inArray(!0,t);e.cells(null,function(n){return n!==s},{page:"current"}).nodes().to$().filter(".dtr-control").removeClass("dtr-control"),e.cells(null,s,{page:"current"}).nodes().to$().addClass("dtr-control")}},_detailsDisplay:function(e,t){var s=this,n=this.s.dt,i=this.c.details;if(i&&i.type!==!1){var o=typeof i.renderer=="string"?b.renderer[i.renderer]():i.renderer,a=i.display(e,t,function(){return o.call(s,n,e[0],s._detailsObj(e[0]))});(a===!0||a===!1)&&r(n.table().node()).triggerHandler("responsive-display.dt",[n,e,a,t])}},_detailsInit:function(){var e=this,t=this.s.dt,s=this.c.details;s.type==="inline"&&(s.target="td.dtr-control, th.dtr-control"),t.on("draw.dtr",function(){e._tabIndexes()}),e._tabIndexes(),r(t.table().body()).on("keyup.dtr","td, th",function(o){o.keyCode===13&&r(this).data("dtr-keyboard")&&r(this).click()});var n=s.target,i=typeof n=="string"?n:"td, th";(n!==void 0||n!==null)&&r(t.table().body()).on("click.dtr mousedown.dtr mouseup.dtr",i,function(o){if(r(t.table().node()).hasClass("collapsed")&&r.inArray(r(this).closest("tr").get(0),t.rows().nodes().toArray())!==-1){if(typeof n=="number"){var a=n<0?t.columns().eq(0).length+n:n;if(t.cell(this).index().column!==a)return}var l=t.row(r(this).closest("tr"));o.type==="click"?e._detailsDisplay(l,!1):o.type==="mousedown"?r(this).css("outline","none"):o.type==="mouseup"&&r(this).trigger("blur").css("outline","")}})},_detailsObj:function(e){var t=this,s=this.s.dt;return r.map(this.s.columns,function(n,i){if(!(n.never||n.control)){var o=s.settings()[0].aoColumns[i];return{className:o.sClass,columnIndex:i,data:s.cell(e,i).render(t.c.orthogonal),hidden:s.column(i).visible()&&!t.s.current[i],rowIndex:e,title:o.sTitle!==null?o.sTitle:r(s.column(i).header()).text()}}})},_find:function(e){for(var t=this.c.breakpoints,s=0,n=t.length;s<n;s++)if(t[s].name===e)return t[s]},_redrawChildren:function(){var e=this,t=this.s.dt;t.rows({page:"current"}).iterator("row",function(s,n){t.row(n),e._detailsDisplay(t.row(n),!0)})},_resize:function(e){var t=this,s=this.s.dt,n=r(window).innerWidth(),i=this.c.breakpoints,o=i[0].name,a=this.s.columns,l,d,u=this.s.current.slice();for(l=i.length-1;l>=0;l--)if(n<=i[l].width){o=i[l].name;break}var p=this._columnsVisiblity(o);this.s.current=p;var c=!1;for(l=0,d=a.length;l<d;l++)if(p[l]===!1&&!a[l].never&&!a[l].control&&s.column(l).visible()){c=!0;break}r(s.table().node()).toggleClass("collapsed",c);var f=!1,v=0;s.columns().eq(0).each(function(x,h){p[h]===!0&&v++,(e||p[h]!==u[h])&&(f=!0,t._setColumnVis(x,p[h]))}),this._redrawChildren(),f&&(r(s.table().node()).trigger("responsive-resize.dt",[s,this.s.current]),s.page.info().recordsDisplay===0&&r("td",s.table().body()).eq(0).attr("colspan",v)),t._controlClass()},_resizeAuto:function(){var e=this.s.dt,t=this.s.columns,s=this;if(this.c.auto&&r.inArray(!0,r.map(t,function(c){return c.auto}))!==-1){r.isEmptyObject(this.s.childNodeStore)||r.each(this.s.childNodeStore,function(c){var f=c.split("-");s._childNodesRestore(e,f[0]*1,f[1]*1)}),e.table().node().offsetWidth,e.columns;var n=e.table().node().cloneNode(!1),i=r(e.table().header().cloneNode(!1)).appendTo(n),o=r(e.table().body()).clone(!1,!1).empty().appendTo(n);n.style.width="auto";var a=e.columns().header().filter(function(c){return e.column(c).visible()}).to$().clone(!1).css("display","table-cell").css("width","auto").css("min-width",0);r(o).append(r(e.rows({page:"current"}).nodes()).clone(!1)).find("th, td").css("display","");var l=e.table().footer();if(l){var d=r(l.cloneNode(!1)).appendTo(n),u=e.columns().footer().filter(function(c){return e.column(c).visible()}).to$().clone(!1).css("display","table-cell");r("<tr/>").append(u).appendTo(d)}r("<tr/>").append(a).appendTo(i),this.c.details.type==="inline"&&r(n).addClass("dtr-inline collapsed"),r(n).find("[name]").removeAttr("name"),r(n).css("position","relative");var p=r("<div/>").css({width:1,height:1,overflow:"hidden",clear:"both"}).append(n);p.insertBefore(e.table().node()),a.each(function(c){var f=e.column.index("fromVisible",c);t[f].minWidth=this.offsetWidth||0}),p.remove()}},_responsiveOnlyHidden:function(){var e=this.s.dt;return r.map(this.s.current,function(t,s){return e.column(s).visible()===!1?!0:t})},_setColumnVis:function(e,t){var s=this,n=this.s.dt,i=t?"":"none";r(n.column(e).header()).css("display",i).toggleClass("dtr-hidden",!t),r(n.column(e).footer()).css("display",i).toggleClass("dtr-hidden",!t),n.column(e).nodes().to$().css("display",i).toggleClass("dtr-hidden",!t),r.isEmptyObject(this.s.childNodeStore)||n.cells(null,e).indexes().each(function(o){s._childNodesRestore(n,o.row,o.column)})},_tabIndexes:function(){var e=this.s.dt,t=e.cells({page:"current"}).nodes().to$(),s=e.settings()[0],n=this.c.details.target;t.filter("[data-dtr-keyboard]").removeData("[data-dtr-keyboard]"),typeof n=="number"?e.cells(null,n,{page:"current"}).nodes().to$().attr("tabIndex",s.iTabIndex).data("dtr-keyboard",1):(n==="td:first-child, th:first-child"&&(n=">td:first-child, >th:first-child"),r(n,e.rows({page:"current"}).nodes()).attr("tabIndex",s.iTabIndex).data("dtr-keyboard",1))}});b.breakpoints=[{name:"desktop",width:1/0},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}];b.display={childRow:function(e,t,s){if(t){if(r(e.node()).hasClass("parent"))return e.child(s(),"child").show(),!0}else return e.child.isShown()?(e.child(!1),r(e.node()).removeClass("parent"),!1):(e.child(s(),"child").show(),r(e.node()).addClass("parent"),!0)},childRowImmediate:function(e,t,s){return!t&&e.child.isShown()||!e.responsive.hasHidden()?(e.child(!1),r(e.node()).removeClass("parent"),!1):(e.child(s(),"child").show(),r(e.node()).addClass("parent"),!0)},modal:function(e){return function(t,s,n){if(s)r("div.dtr-modal-content").empty().append(n());else{var i=function(){o.remove(),r(document).off("keypress.dtr")},o=r('<div class="dtr-modal"/>').append(r('<div class="dtr-modal-display"/>').append(r('<div class="dtr-modal-content"/>').append(n())).append(r('<div class="dtr-modal-close">&times;</div>').click(function(){i()}))).append(r('<div class="dtr-modal-background"/>').click(function(){i()})).appendTo("body");r(document).on("keyup.dtr",function(a){a.keyCode===27&&(a.stopPropagation(),i())})}e&&e.header&&r("div.dtr-modal-content").prepend("<h2>"+e.header(t)+"</h2>")}}};b.renderer={listHiddenNodes:function(){return function(e,t,s){var n=this,i=r('<ul data-dtr-index="'+t+'" class="dtr-details"/>'),o=!1;return r.each(s,function(a,l){if(l.hidden){var d=l.className?'class="'+l.className+'"':"";r("<li "+d+' data-dtr-index="'+l.columnIndex+'" data-dt-row="'+l.rowIndex+'" data-dt-column="'+l.columnIndex+'"><span class="dtr-title">'+l.title+"</span> </li>").append(r('<span class="dtr-data"/>').append(n._childNodes(e,l.rowIndex,l.columnIndex))).appendTo(i),o=!0}}),o?i:!1}},listHidden:function(){return function(e,t,s){var n=r.map(s,function(i){var o=i.className?'class="'+i.className+'"':"";return i.hidden?"<li "+o+' data-dtr-index="'+i.columnIndex+'" data-dt-row="'+i.rowIndex+'" data-dt-column="'+i.columnIndex+'"><span class="dtr-title">'+i.title+'</span> <span class="dtr-data">'+i.data+"</span></li>":""}).join("");return n?r('<ul data-dtr-index="'+t+'" class="dtr-details"/>').append(n):!1}},tableAll:function(e){return e=r.extend({tableClass:""},e),function(t,s,n){var i=r.map(n,function(o){var a=o.className?'class="'+o.className+'"':"";return"<tr "+a+' data-dt-row="'+o.rowIndex+'" data-dt-column="'+o.columnIndex+'"><td>'+o.title+":</td> <td>"+o.data+"</td></tr>"}).join("");return r('<table class="'+e.tableClass+' dtr-details" width="100%"/>').append(i)}}};b.defaults={breakpoints:b.breakpoints,auto:!0,details:{display:b.display.childRow,renderer:b.renderer.listHidden(),target:0,type:"inline"},orthogonal:"display"};var k=r.fn.dataTable.Api;k.register("responsive()",function(){return this});k.register("responsive.index()",function(e){return e=r(e),{column:e.data("dtr-index"),row:e.parent().data("dtr-index")}});k.register("responsive.rebuild()",function(){return this.iterator("table",function(e){e._responsive&&e._responsive._classLogic()})});k.register("responsive.recalc()",function(){return this.iterator("table",function(e){e._responsive&&(e._responsive._resizeAuto(),e._responsive._resize())})});k.register("responsive.hasHidden()",function(){var e=this.context[0];return e._responsive?r.inArray(!1,e._responsive._responsiveOnlyHidden())!==-1:!1});k.registerPlural("columns().responsiveHidden()","column().responsiveHidden()",function(){return this.iterator("column",function(e,t){return e._responsive?e._responsive._responsiveOnlyHidden()[t]:!1},1)});b.version="2.4.1";r.fn.dataTable.Responsive=b;r.fn.DataTable.Responsive=b;r(document).on("preInit.dt.dtr",function(e,t,s){if(e.namespace==="dt"&&(r(t.nTable).hasClass("responsive")||r(t.nTable).hasClass("dt-responsive")||t.oInit.responsive||y.defaults.responsive)){var n=t.oInit.responsive;n!==!1&&new b(t,r.isPlainObject(n)?n:{})}});const $="aÄiÄ«uÅ«á¹á¹eÄoÅkgá¹cjÃ±á¹­á¸á¹tdnpbmyrlvá¸»á¸·á¹á¹Åá¹£sh".split("").reverse(),q=new Map;for(const[e,t]of $.entries())q.set(t,e);const T=(e,t,s="asc")=>{const n=Math.min(e.length,t.length);let i=0;for(;i<n;){const o=e.charAt(i).toLowerCase(),a=t.charAt(i).toLowerCase();if(o===a)i++;else{const l=q.get(o)||-1,d=q.get(a)||-1;return s==="asc"?l<d:l>d}}return s==="asc"?e.length>t.length:e.length<t.length};y.ext.type.search.tamil=e=>e?e.replace(/<.*?>|\u00AD/g,"").replace(/\s+/," ").toLowerCase():"";const N=e=>e?e.replace(/<.*?>|\u00AD/g,"").replace(/\s+/," ").toLowerCase():"";y.ext.type.order["tamil-asc"]=(e,t)=>T(N(e),N(t),"asc");y.ext.type.order["tamil-desc"]=(e,t)=>T(N(e),N(t),"desc");y.ext.type.order["shelfmark-pre"]=e=>e?e.replace(/\d+/g,t=>t.padStart(4,"0")):"0000";y.ext.type.order["extent-pre"]=e=>e.match(/^\d+ f?f.$/)?parseInt(e)*2:parseInt(e);y.ext.type.order["numrange-pre"]=e=>{if(e.match("â")){const t=e.split("â");return t[0]||t[1]}else return e};y.ext.type.order["hyphenated-pre"]=e=>e?e.replace(/<.*?>|\u00AD/g,"").replace(/\s+/g," ").toLowerCase():"";y.ext.type.search.hyphenated=e=>e?e.replace(/<.*?>|\u00AD/g,"").replace(/\s+/g," ").toLowerCase():"";const E=function(e){for(var t=e.target.closest("[data-anno]");t&&t.hasAttribute("data-anno");)S.make(e,t),t=t.parentNode},S={make:function(e,t){const s=t.dataset.anno;if(!s)return;var n=document.getElementById("tooltip");const i=document.createElement("div");if(n){for(const o of n.childNodes)if(o.myTarget===t)return;i.appendChild(document.createElement("hr"))}else n=document.createElement("div"),n.id="tooltip",n.style.top=e.clientY+10+"px",n.style.left=e.clientX+"px",document.body.appendChild(n),i.myTarget=t;i.appendChild(document.createTextNode(s)),i.myTarget=t,n.appendChild(i),t.addEventListener("mouseleave",S.remove,{once:!0}),n.animate([{opacity:0},{opacity:1,easing:"ease-in"}],200)},remove:function(e){const t=document.getElementById("tooltip");if(!t)return;if(t.children.length===1){t.remove();return}const s=e.target;for(const n of t.childNodes)if(n.myTarget===s){n.remove();break}if(t.children.length===1){const n=t.firstChild.firstChild;n.tagName==="HR"&&n.remove()}}},A=new Map([["shelfmark",{title:"shelfmark",type:"shelfmark",sql:"mss.filename, shelfmark",post:e=>`<a href="/mss/${e.filename}" class="shelfmark">${e.shelfmark}</a>`}],["repository",{sql:"repository",title:"repository"}],["title",{sql:"title",title:"title",type:"tamil",post:e=>_(e.title)}],["languages",{sql:"languages",title:"languages"}],["material",{sql:"material",title:"material"}],["width",{sql:"width",title:"width"}],["height",{sql:"height",title:"height"}],["extent",{sql:"extent",title:"extent",type:"extent"}],["date",{sql:"date",title:"date",type:"daterange"}],["images",{sql:"images",title:"images",post:e=>e.images?`<span class="smallcaps">${e.images}</span>`:""}],["blessing",{sql:"paratexts_blessing.text AS blessing",title:"blessing",table:"paratexts_blessing",type:"tamil",post:e=>_(e.blessing)}],["colophon",{sql:"paratexts_colophon.text AS colophon",title:"colophon",table:"paratexts_colophon",type:"tamil",post:e=>_(e.colophon)}],["header",{sql:"paratexts_header.text AS header",title:"header",table:"paratexts_header",type:"tamil",post:e=>_(e.header)}],["invocation",{sql:"paratexts_invocation.text AS invocation",title:"invocation",table:"paratexts_invocation",type:"tamil",post:e=>_(e.invocation)}],["ownership-statement",{sql:"[paratexts_ownership-statement].text AS [ownership-statement]",title:"ownership statement",table:"[paratexts_ownership-statement]",type:"tamil",post:e=>_(e["ownership-statement"])}],["satellite-stanza",{sql:"[paratexts_satellite-stanza].text AS [satellite-stanza]",title:"satellite stanza",table:"[paratexts_satellite-stanza]",type:"tamil",post:e=>_(e["satellite-stanza"])}],["table-of-contents",{sql:"[paratexts_table-of-contents].text AS [table-of-contents]",title:"table of contents",table:"[paratexts_table-of-contents]",type:"tamil",post:e=>_(e["table-of-contents"])}],["paratext_title",{sql:"paratexts_title.text AS paratext_title",title:"title",table:"[paratexts_title]",type:"tamil",post:e=>_(e.paratext_title)}],["tbc",{sql:"paratexts_TBC.text AS [tbc]",title:"TBC",table:"[paratexts_TBC]",type:"tamil",post:e=>_(e.tbc)}],["g_below-base",{sql:"[g_below-base].context AS [g_below-base], [g_below-base].text as [g_below-base_sort]",title:"ligature",table:"[g_below-base]",type:"tamil",render:{_:"display",sort:"sort"},post:e=>({display:_(e["g_below-base"]),sort:e["g_below-base_sort"]})}],["g_post-base",{sql:"[g_post-base].context AS [g_post-base], [g_post-base].text as [g_post-base_sort]",title:"ligature",table:"[g_post-base]",type:"tamil",render:{_:"display",sort:"sort"},post:e=>({display:_(e["g_post-base"]),sort:e["g_post-base_sort"]})}],["synch",{sql:"synch",title:"unit"}],["milestone",{sql:"milestone, facs",title:"page/folio",post:e=>e.milestone&&e.facs?`<a href="/mss/${e.filename}?facs=${e.facs}">${e.milestone}</a>`:e.milestone}],["placement",{sql:"placement",title:"placement"}]]),D=["Ancien fonds","Ariel","w/d","Burnouf","Cordier","Ducler","Haas","Reydellet","Vinson"];for(const e of D)A.set(`old_shelfmarks(${e})`,{title:"old shelfmark",type:"shelfmark",sql:`json_extract(old_shelfmarks, '$.${e}') AS 'old_shelfmarks(${e})'`});const R=async e=>{const t=await z("/mss/db/meta.db"),s=["shelfmark","repository","title","languages","material","extent","date","images"],n=[],i=[],o=e.dataset.sqlcolumns,a=o?o.split(", "):s,l=[];for(const m of a){const g=A.get(m);g&&(l.push(g.sql),g.table&&n.push(`INNER JOIN ${g.table} ON ${g.table}.filename = mss.filename`))}const d=e.dataset.collection;d&&(n.push("INNER JOIN collections ON collections.filename = mss.filename"),i.push(`collections.collection = "${d}"`));const u=e.dataset.repository;u&&i.push(`mss.repository = "${u}"`);const p=e.dataset.collector;p&&(n.push("INNER JOIN persons ON persons.filename = mss.filename"),i.push(`persons.persname = "${p}" AND persons.role = "collector"`));const c=l.join(", ")+" ",f=n.join(" "),v=i.length>0?`WHERE ${i.join(" AND ")}`:"",h=(await t.db.query(`SELECT ${c} FROM mss ${f} ${v} ORDER BY mss.filename`)).map(m=>{const g={};for(const C of a){const I=A.get(C);I?g[C]=I.post?I.post(m)||"":m[C]:g[C]=m[C]||""}return g}),w=a.map(m=>{const g=A.get(m),C={data:m,title:g.title};return g.type&&(C.type=g.type),g.render&&(C.render=g.render),C});return{rows:h,columns:w}};window.addEventListener("load",async()=>{const e=document.getElementById("index");if(!e)return;const t=await R(e);new y("#index",{searchable:!0,language:{search:"Filter:"},paging:!0,pageLength:100,lengthMenu:[[25,50,100,-1],[25,50,100,"All"]],sortable:!0,data:t.rows,columns:t.columns,responsive:!0}),document.getElementById("spinner").style.display="none";const s=document.getElementById("tabright");s&&(s.style.visibility="visible"),document.getElementById("index").style.visibility="visible",e.addEventListener("mouseover",E)});

import{a as v,s as B,h as C,D as b}from"./hyphenate-21a7b665.js";/* empty css                          *//* empty css              */import{Sanscript as A}from"https://tst-project.github.io/lib/js/sanscript.mjs";var x={},k={get exports(){return x},set exports(o){x=o}},w={};(function(o){var r=o,l=/`/g,S=/\./g,h=/[']/g,E={"'":"''"};r.escapeId=function(e,n){if(Array.isArray(e)){for(var t="",s=0;s<e.length;s++)t+=(s===0?"":", ")+r.escapeId(e[s],n);return t}else return n?"`"+String(e).replace(l,"``")+"`":"`"+String(e).replace(l,"``").replace(S,"`.`")+"`"},r.escape=function(e,n,t){if(e==null)return"NULL";switch(typeof e){case"boolean":return e?"true":"false";case"number":return e+"";case"object":return e instanceof Date?r.dateToString(e,t||"local"):Array.isArray(e)?r.arrayToList(e,t):Buffer.isBuffer(e)?r.bufferToString(e):typeof e.toSqlString=="function"?String(e.toSqlString()):n?d(e.toString()):r.objectToValues(e,t);default:return d(e)}},r.arrayToList=function(e,n){for(var t="",s=0;s<e.length;s++){var i=e[s];Array.isArray(i)?t+=(s===0?"":", ")+"("+r.arrayToList(i,n)+")":t+=(s===0?"":", ")+r.escape(i,!0,n)}return t},r.format=function(e,n,t,s){if(n==null)return e;n instanceof Array||Array.isArray(n)||(n=[n]);for(var i=0,p=/\?+/g,f="",u=0,g;u<n.length&&(g=p.exec(e));){var m=g[0].length;if(!(m>2)){var y=m===2?r.escapeId(n[u]):r.escape(n[u],t,s);f+=e.slice(i,g.index)+y,i=p.lastIndex,u++}}return i===0?e:i<e.length?f+e.slice(i):f},r.dateToString=function(e,n){var t=new Date(e);if(isNaN(t.getTime()))return"NULL";var s,i,p,f,u,g,m;if(n==="local")s=t.getFullYear(),i=t.getMonth()+1,p=t.getDate(),f=t.getHours(),u=t.getMinutes(),g=t.getSeconds(),m=t.getMilliseconds();else{var y=T(n);y!==!1&&y!==0&&t.setTime(t.getTime()+y*6e4),s=t.getUTCFullYear(),i=t.getUTCMonth()+1,p=t.getUTCDate(),f=t.getUTCHours(),u=t.getUTCMinutes(),g=t.getUTCSeconds(),m=t.getUTCMilliseconds()}var L=c(s,4)+"-"+c(i,2)+"-"+c(p,2)+" "+c(f,2)+":"+c(u,2)+":"+c(g,2)+"."+c(m,3);return d(L)},r.bufferToString=function(e){return"X"+d(e.toString("hex"))},r.objectToValues=function(e,n){var t="";for(var s in e){var i=e[s];typeof i!="function"&&(t+=(t.length===0?"":", ")+r.escapeId(s)+" = "+r.escape(i,!0,n))}return t},r.raw=function(e){if(typeof e!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return e}}};function d(a){for(var e=h.lastIndex=0,n="",t;t=h.exec(a);)n+=a.slice(e,t.index)+E[t[0]],e=h.lastIndex;return e===0?"'"+a+"'":e<a.length?"'"+n+a.slice(e)+"'":"'"+n+"'"}function c(a,e){for(a=a.toString();a.length<e;)a="0"+a;return a}function T(a){if(a==="Z")return 0;var e=a.match(/([\+\-\s])(\d\d):?(\d\d)?/);return e?(e[1]==="-"?-1:1)*(parseInt(e[2],10)+(e[3]?parseInt(e[3],10):0)/60)*60:!1}})(w);(function(o){o.exports=w})(k);const q=v(x),P=async o=>{document.getElementById("spinner").style.display="flex";const r=await B("/mss/db/fts.db"),l=o.replaceAll("ए","ऎ").replaceAll("ओ","ऒ").replaceAll("े","ॆ").replaceAll("ो","ॊ"),S=A.t(A.t(l,"tamil","iast"),"devanagari","iast").replace(/^⁰|([^\d⁰])⁰/g,"$1¹⁰"),h=q.escape(S).replace(/"/g,'""').replace(/^'/,`'"`).replace(/'$/,`"'`),E=await r.db.exec(`SELECT filename, shelfmark, title, snippet(fulltext,3,'<span class="highlit">','</span>','…',200) AS snippet FROM fulltext WHERE text MATCH ${h} ORDER BY rank`);if(document.getElementById("spinner").style.display="none",E.length===0){document.getElementById("noresulttext").textContent=S,document.getElementById("noresult").style.visibility="visible";return}const d=E[0].values.map(c=>{const T=`<a href="/mss/${c[0]}" class="shelfmark">${c[1]}</a>`,a=C(c[2]);return[T,a,c[3]]});document.getElementById("index").style.visibility="visible",new b("#index",{searchable:!0,language:{search:"Filter:"},paging:!0,pageLength:100,lengthMenu:[[25,50,100,-1],[25,50,100,"All"]],sortable:!0,data:d,columns:[{title:"shelfmark",type:"shelfmark"},{title:"title",type:"tamil"},{title:"search result"}]})},I=o=>{const r=new URLSearchParams(window.location.search);r.set("q",o),window.location.search=r};document.getElementById("ftsinput").addEventListener("keyup",o=>{if(event.keyCode!==13)return;const r=o.target.value.trim();r!==""&&I(r)});document.getElementById("ftsbutton").addEventListener("click",o=>{const r=document.getElementById("ftsinput").value.trim();r!==""&&I(r)});const R=o=>{const l=new URLSearchParams(window.location.search).get("q");l&&(document.getElementById("ftsinput").value=l,P(l))};window.addEventListener("load",R);
